---
layout: post
title:  "로컬 VM 구성하기"
date:   2015-07-24 08:00:00
categories: Nodejs서버강좌 vagrant ansible
comments: true
---

* content
{:toc}

## 들어가는 말

[따라하면서 배우는 NGUI 유니티 게임 프로그래밍](http://wikibook.co.kr/unity-ngui/) 내용 중 136페이지 이상을 차지한 내용이 네트워크 작업이었다. 네트워크 작업을 하는 환경구축이 어려울까봐 [WPN-XM](http://wpn-xm.org/)을 소개했다. [^1]
하지만 해당 환경은 windows 사용자에게만 해당하는 내용이었고 유연하지도 못했다. 이 글을 통해서 쉽게 환경을 구축하도록 설명하겠다. [^2]

---

## 필요사항

* Virtualbox >= 4.3.10 - [Install](https://www.virtualbox.org/wiki/Downloads)
* Vagrant >= 1.5.4 - [Install](http://www.vagrantup.com/downloads.html) • [Docs](https://docs.vagrantup.com/v2/)

Virtualbox와 Vagrant를 먼저 설치해야만 진행이 가능하다. 환경에 따라 설치 버전을 제공하므로 어렵지 않게 설치 할 수 있을 것이다.

---

## 설치방법

1. [lemp레포지토리](https://github.com/totuworld/lemp)로 이동하여 [DownloadZip](https://github.com//totuworld/lemp/archive/master.zip)버튼으로 다운받거나 git으로 클론(복제)한다.
2. 해당 폴더로 이동하여 OS 환경에 따라 명령을 입력하거나 파일을 실행한다.

OS | 명령
--- | --- 
windows | startserver.bat 실행
osx | 터미널에서 `vagrant up` 실행 [^3]

처음 실행한다면 ubuntu 이미지를 다운받기 때문에 시간이 필요할 수 있다.

정상적으로 실행이 되었다면 터미널 창에 아래와 같은 내용이 표시되기 시작할 것이다.

```bash
Bringing machine 'default' up with 'virtualbox' provider...
==> default: Clearing any previously set forwarded ports...
==> default: Clearing any previously set network interfaces...
==> default: Preparing network interfaces based on configuration...
    default: Adapter 1: nat
==> default: Forwarding ports...
    default: 80 => 8080 (adapter 1)
    default: 3306 => 6306 (adapter 1)
    default: 22 => 2222 (adapter 1)
==> default: Booting VM...
==> default: Waiting for machine to boot. This may take a few minutes...
    default: SSH address: 127.0.0.1:2222
    default: SSH username: vagrant
    default: SSH auth method: private key
    default: Warning: Connection timeout. Retrying...
    default: Warning: Remote connection disconnect. Retrying...
==> default: Machine booted and ready!
==> default: Checking for guest additions in VM...
==> default: Setting hostname...
==> default: Mounting shared folders...
    default: /vagrant => /Users/imac/Desktop/yochang/work/vagrant_vms/lemp
==> default: Machine already provisioned. Run `vagrant provision` or use the `--provision`
==> default: flag to force provisioning. Provisioners marked to run always will still run.
imacui-iMac:lemp imac$ vagrant halt
==> default: Attempting graceful shutdown of VM...
imacui-iMac:lemp imac$ vagrant destroy
    default: Are you sure you want to destroy the 'default' VM? [y/N] y
==> default: Destroying VM and associated drives...
==> default: Running cleanup tasks for 'shell' provisioner...
imacui-iMac:lemp imac$ clear
imacui-iMac:lemp imac$ vagrant up
Bringing machine 'default' up with 'virtualbox' provider...
==> default: Importing base box 'ubuntu/trusty64'...
==> default: Matching MAC address for NAT networking...
==> default: Setting the name of the VM: lemp_default_1437693395300_17138
==> default: Clearing any previously set forwarded ports...
==> default: Clearing any previously set network interfaces...
==> default: Preparing network interfaces based on configuration...
    default: Adapter 1: nat
==> default: Forwarding ports...
    default: 80 => 8080 (adapter 1)
    default: 3306 => 6306 (adapter 1)
    default: 22 => 2222 (adapter 1)
==> default: Booting VM...
==> default: Waiting for machine to boot. This may take a few minutes...
    default: SSH address: 127.0.0.1:2222
    default: SSH username: vagrant
    default: SSH auth method: private key
    default: Warning: Connection timeout. Retrying...
    default:
    default: Vagrant insecure key detected. Vagrant will automatically replace
    default: this with a newly generated keypair for better security.
    default:
    default: Inserting generated public key within guest...
    default: Removing insecure key from the guest if it's present...
    default: Key inserted! Disconnecting and reconnecting using new SSH key...
==> default: Machine booted and ready!
==> default: Checking for guest additions in VM...
==> default: Setting hostname...
==> default: Mounting shared folders...
    default: /vagrant => /Users/imac/Desktop/yochang/work/vagrant_vms/lemp
==> default: Running provisioner: shell...
    default: Running: /var/folders/2x/wjkhst994q90znbx4bdtd9vc0000gn/T/vagrant-shell20150724-3894-t1do3x.sh
```

---

[^1]: 소개는 했지만 실제 문서 작성을 osx 환경에서 진행하여 사용하지는 않았었다.

[^2]: 사실은 책 후반부가 허술하다고 생각되어 연재되는 강좌로 만회하고자 한다.

[^3]: `control + space`를 누르고 `terminal`혹은 `터미널`로 입력한다. 폴더로 이동 하려면 파인더의 해당 폴더를 터미널에 끌어다 놓으면 된다. 